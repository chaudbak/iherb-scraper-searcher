!function(){function a(){}function b(a,b){this.model=a,this.options=b||{},this.options.threshold=this.options.threshold||100,this.store=window.localStorage}function c(a){this.page_no=1,this.total_pages=1,this.total_results=1,this.results_per_page=a.results_per_page||100,this.removed=[],this.data=[],this.checkedBox={},this.allnutrients={},this.categories=a.categories}function d(){var a=g.getJSON("data/results.json"),b=g.getJSON("data/nutrients.json");nunjucks.configure({watch:!1}),Promise.all([a,b]).then(function(a){h.setData(a[0]),h.setNutrientsInfo(a[1]),i.render(!0)})}a.prototype.getJSON=function(a){return new Promise(function(b,c){var d=new XMLHttpRequest;d.open("GET",a),d.responseType="json",d.onload=function(){200===d.status?b(d.response):c(Error("Request failed error:"+d.statusText))},d.onerror=function(){c(Error("There was a network error."))},d.send()})},b.prototype.isBelowThreshold=function(a){return!a||a&&a.percent_dv<this.options.threshold},b.prototype.allAboveThreshold=function(a){var b=this,c=Object.keys(b.model.checkedBox);return c.every(function(c){var d=a[c];return!!(d&&d.percent_dv>=b.options.threshold)})},b.prototype.render=function(a){a&&this.model.reset();var b=nunjucks.render("results.html",this.model);document.getElementById("results").innerHTML=b},b.prototype.addEvents=function(){var a=this;document.addEventListener("click",function(b){var c=a.model,d=b.target.dataset,e=d.key,f=d.navigate;if(e){var g=a.store,h=g.getItem(e)||1;a.model.sortBy(e,h),g.setItem(e,-1*h),a.render(!0)}else f&&("next"===f?c.page_no+=1:c.page_no-=1,a.render(!1))}),document.addEventListener("change",function(b){{var c=a.model,d=b.target,e=c.data,f=c.removed,g=d.parentElement.textContent.trim();d.dataset.category}if(delete c.checkedBox[g],d.checked){c.checkedBox[g]="checked";for(var h=0;h<e.length;h++){var i=e[h].nutrients[g];a.isBelowThreshold(i)&&(f.push(e.splice(h,1)[0]),h-=1)}}else if(f.length>0)for(var h=0;h<f.length;h++){var j=f[h].nutrients,k=j[g];a.isBelowThreshold(k)&&a.allAboveThreshold(j)&&(c.data.push(f.splice(h,1)[0]),h-=1)}a.render(!0)})},c.prototype.setData=function(a){this.data=a},c.prototype.setNutrientsInfo=function(a){this.allnutrients=a},c.prototype.sortBy=function(a,b){this.data=this.data.sort(function(c,d){return(c[a]-d[a])*b})},c.prototype.reset=function(){this.total_results=this.data.length,this.total_pages=Math.ceil(this.total_results/this.results_per_page),this.page_no=1};var e=100,f=["Vitamins","Minerals","Trace Elements","Enzymes","Probiotics","Macronutrients","Amino Acids"],g=new a,h=new c({categories:f}),i=new b(h,{threshold:e});i.addEvents(),d(),WebFontConfig={google:{families:["Titillium+Web:400,700:latin"]}};var j=document.createElement("script");j.src=("https:"==document.location.protocol?"https":"http")+"://ajax.googleapis.com/ajax/libs/webfont/1/webfont.js",j.type="text/javascript",j.async="true";var k=document.getElementsByTagName("script")[0];k.parentNode.insertBefore(j,k)}();